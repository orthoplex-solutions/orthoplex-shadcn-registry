{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "masked-input",
  "title": "Masked Input",
  "description": "An input component with automatic formatting mask support. Format phone numbers, dates, postal codes, and more.",
  "files": [
    {
      "path": "registry/masked-input/masked-input.tsx",
      "content": "'use client';\n\nimport * as React from 'react';\n\nexport interface MaskedInputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {\n  /**\n   * Mask pattern where:\n   * 9 = digit (0-9)\n   * a = letter (A-Z)\n   * * = alphanumeric\n   * Other characters = literal (shown as-is)\n   *\n   * Examples:\n   * \"(999) 999-9999\" for phone\n   * \"99/99/9999\" for date\n   * \"a9a 9a9\" for postal code\n   */\n  mask: string;\n\n  /**\n   * Called when value changes with both formatted and clean values\n   * formatted: \"(555) 555-5555\"\n   * unformatted: \"5555555555\"\n   */\n  onMaskedChange?: (formatted: string, unformatted: string) => void;\n}\n\nconst MaskedInput = React.forwardRef<HTMLInputElement, MaskedInputProps>(\n  (\n    {\n      className,\n      mask,\n      onChange,\n      onMaskedChange,\n      value: controlledValue,\n      ...props\n    },\n    ref\n  ) => {\n    const [value, setValue] = React.useState<string>('');\n    const displayValue =\n      controlledValue !== undefined ? controlledValue : value;\n\n    /**\n     * Check if character matches mask pattern\n     * '9' only accepts digits\n     * 'a' only accepts letters\n     * '*' accepts both\n     */\n    const charMatchesMask = (char: string, maskChar: string): boolean => {\n      if (maskChar === '9') return /\\d/.test(char);\n      if (maskChar === 'a') return /[A-Za-z]/.test(char);\n      if (maskChar === '*') return /[A-Za-z0-9]/.test(char);\n      return false;\n    };\n\n    /**\n     * Format input according to mask\n     *\n     * Example:\n     * Input: \"5555555555\"\n     * Mask: \"(999) 999-9999\"\n     * Output: \"(555) 555-5555\"\n     */\n    const formatToMask = (\n      inputValue: string\n    ): { formatted: string; unformatted: string } => {\n      let formatted = '';\n      let unformatted = '';\n      let inputIndex = 0;\n\n      for (let maskIndex = 0; maskIndex < mask.length; maskIndex++) {\n        const maskChar = mask[maskIndex];\n\n        // If mask position is a placeholder (9, a, or *)\n        if (['9', 'a', '*'].includes(maskChar)) {\n          if (inputIndex < inputValue.length) {\n            const char = inputValue[inputIndex];\n\n            // Check if typed character matches the mask requirement\n            if (charMatchesMask(char, maskChar)) {\n              formatted += char;\n              unformatted += char;\n              inputIndex++;\n            }\n            // Skip this mask position if char doesn't match\n          } else {\n            // No more input, stop formatting\n            break;\n          }\n        } else {\n          // This is a literal character (like parenthesis, dash, space)\n          if (\n            inputIndex < inputValue.length &&\n            inputValue[inputIndex] === maskChar\n          ) {\n            // User typed the literal character\n            formatted += maskChar;\n            inputIndex++;\n          } else if (inputIndex < inputValue.length) {\n            // User didn't type the literal, try to auto-insert it\n            const nextMaskIndex = maskIndex + 1;\n            if (\n              nextMaskIndex < mask.length &&\n              ['9', 'a', '*'].includes(mask[nextMaskIndex])\n            ) {\n              if (\n                charMatchesMask(inputValue[inputIndex], mask[nextMaskIndex])\n              ) {\n                formatted += maskChar;\n              } else {\n                break;\n              }\n            } else {\n              formatted += maskChar;\n            }\n          } else {\n            // No more input, stop\n            break;\n          }\n        }\n      }\n\n      return {\n        formatted,\n        unformatted,\n      };\n    };\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      let inputValue = e.target.value;\n\n      // Extract only alphanumeric characters (remove any formatting)\n      const validChars = inputValue\n        .split('')\n        .filter((char) => /[A-Za-z0-9]/.test(char))\n        .join('');\n\n      const { formatted, unformatted } = formatToMask(validChars);\n\n      // Update state if uncontrolled component\n      if (controlledValue === undefined) {\n        setValue(formatted);\n      }\n\n      // Call onChange with formatted value\n      if (onChange) {\n        e.target.value = formatted;\n        onChange(e);\n      }\n\n      // Call custom callback with both versions\n      if (onMaskedChange) {\n        onMaskedChange(formatted, unformatted);\n      }\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n      const allowedKeys = [\n        'Backspace',\n        'Delete',\n        'ArrowLeft',\n        'ArrowRight',\n        'Tab',\n        'Enter',\n      ];\n\n      const isModifierKey = e.ctrlKey || e.metaKey || e.altKey || e.shiftKey;\n\n      // Allow modifier keys (Ctrl+C, Ctrl+V, etc.)\n      if (isModifierKey) return;\n\n      // Allow allowed keys\n      if (allowedKeys.includes(e.key)) return;\n\n      // Allow valid characters based on mask\n      if (/[A-Za-z0-9]/.test(e.key)) return;\n\n      // Block everything else\n      e.preventDefault();\n    };\n\n    const handlePaste = (e: React.ClipboardEvent<HTMLInputElement>) => {\n      e.preventDefault();\n      const pastedText = e.clipboardData.getData('text/plain');\n\n      // Extract only alphanumeric from pasted text\n      const validChars = pastedText\n        .split('')\n        .filter((char) => /[A-Za-z0-9]/.test(char))\n        .join('');\n\n      const { formatted, unformatted } = formatToMask(validChars);\n\n      if (controlledValue === undefined) {\n        setValue(formatted);\n      }\n\n      const input = e.currentTarget;\n      input.value = formatted;\n\n      if (onChange) {\n        onChange({\n          ...e,\n          target: input,\n        } as React.ChangeEvent<HTMLInputElement>);\n      }\n\n      if (onMaskedChange) {\n        onMaskedChange(formatted, unformatted);\n      }\n    };\n\n    return (\n      <input\n        className={`flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-base ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${\n          className || ''\n        }`}\n        value={displayValue}\n        onChange={handleChange}\n        onKeyDown={handleKeyDown}\n        onPaste={handlePaste}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\n\nMaskedInput.displayName = 'MaskedInput';\n\nexport { MaskedInput };\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:ui"
}